!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).VueA11yDialog={},t.Vue)}(this,(function(t,e){"use strict";var i=['a[href]:not([tabindex^="-"])','area[href]:not([tabindex^="-"])','input:not([type="hidden"]):not([type="radio"]):not([disabled]):not([tabindex^="-"])','input[type="radio"]:not([disabled]):not([tabindex^="-"]):checked','select:not([disabled]):not([tabindex^="-"])','textarea:not([disabled]):not([tabindex^="-"])','button:not([disabled]):not([tabindex^="-"])','iframe:not([tabindex^="-"])','audio[controls]:not([tabindex^="-"])','video[controls]:not([tabindex^="-"])','[contenteditable]:not([tabindex^="-"])','[tabindex]:not([tabindex^="-"])'];function o(t,e){this._show=this.show.bind(this),this._hide=this.hide.bind(this),this._maintainFocus=this._maintainFocus.bind(this),this._bindKeypress=this._bindKeypress.bind(this),this._previouslyFocused=null,this.container=t,this.dialog=t.querySelector('dialog, [role="dialog"], [role="alertdialog"]'),this.role=this.dialog.getAttribute("role")||"dialog",this.useDialog="show"in this.dialog,this._listeners={},this.create(e)}function n(t){return Array.prototype.slice.call(t)}function s(t,e){return n((e||document).querySelectorAll(t))}function a(t){var e=r(t),i=t.querySelector("[autofocus]")||e[0];i&&i.focus()}function r(t){return s(i.join(","),t).filter((function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)}))}function d(){s("[data-a11y-dialog]").forEach((function(t){new o(t,t.getAttribute("data-a11y-dialog")||void 0)}))}o.prototype.create=function(t){var e,i;return this._targets=this._targets||function(t){if(NodeList.prototype.isPrototypeOf(t))return n(t);if(Element.prototype.isPrototypeOf(t))return[t];if("string"==typeof t)return s(t)}(t)||(e=this.container,(i=n(e.parentNode.childNodes).filter((function(t){return 1===t.nodeType}))).splice(i.indexOf(e),1),i),this.shown=this.dialog.hasAttribute("open"),this.dialog.setAttribute("role",this.role),this.useDialog?(this.container.setAttribute("data-a11y-dialog-native",""),this.container.removeAttribute("aria-hidden")):this.shown?this.container.removeAttribute("aria-hidden"):this.container.setAttribute("aria-hidden",!0),this._openers=s('[data-a11y-dialog-show="'+this.container.id+'"]'),this._openers.forEach(function(t){t.addEventListener("click",this._show)}.bind(this)),this._closers=s("[data-a11y-dialog-hide]",this.container).concat(s('[data-a11y-dialog-hide="'+this.container.id+'"]')),this._closers.forEach(function(t){t.addEventListener("click",this._hide)}.bind(this)),this._fire("create"),this},o.prototype.show=function(t){return this.shown||(this.shown=!0,this._previouslyFocused=document.activeElement,this.useDialog?this.dialog.showModal(t instanceof Event?void 0:t):(this.dialog.setAttribute("open",""),this.container.removeAttribute("aria-hidden"),this._targets.forEach((function(t){t.hasAttribute("aria-hidden")&&t.setAttribute("data-a11y-dialog-original-aria-hidden",t.getAttribute("aria-hidden")),t.setAttribute("aria-hidden","true")}))),a(this.dialog),document.body.addEventListener("focus",this._maintainFocus,!0),document.addEventListener("keydown",this._bindKeypress),this._fire("show",t)),this},o.prototype.hide=function(t){return this.shown?(this.shown=!1,this.useDialog?this.dialog.close(t instanceof Event?void 0:t):(this.dialog.removeAttribute("open"),this.container.setAttribute("aria-hidden","true"),this._targets.forEach((function(t){t.hasAttribute("data-a11y-dialog-original-aria-hidden")?(t.setAttribute("aria-hidden",t.getAttribute("data-a11y-dialog-original-aria-hidden")),t.removeAttribute("data-a11y-dialog-original-aria-hidden")):t.removeAttribute("aria-hidden")}))),this._previouslyFocused&&this._previouslyFocused.focus&&this._previouslyFocused.focus(),document.body.removeEventListener("focus",this._maintainFocus,!0),document.removeEventListener("keydown",this._bindKeypress),this._fire("hide",t),this):this},o.prototype.destroy=function(){return this.hide(),this._openers.forEach(function(t){t.removeEventListener("click",this._show)}.bind(this)),this._closers.forEach(function(t){t.removeEventListener("click",this._hide)}.bind(this)),this._fire("destroy"),this._listeners={},this},o.prototype.on=function(t,e){return void 0===this._listeners[t]&&(this._listeners[t]=[]),this._listeners[t].push(e),this},o.prototype.off=function(t,e){var i=(this._listeners[t]||[]).indexOf(e);return i>-1&&this._listeners[t].splice(i,1),this},o.prototype._fire=function(t,e){(this._listeners[t]||[]).forEach(function(t){t(this.container,e)}.bind(this))},o.prototype._bindKeypress=function(t){this.dialog.contains(document.activeElement)&&(this.shown&&27===t.which&&"alertdialog"!==this.role&&(t.preventDefault(),this.hide(t)),this.shown&&9===t.which&&function(t,e){var i=r(t),o=i.indexOf(document.activeElement);e.shiftKey&&0===o?(i[i.length-1].focus(),e.preventDefault()):e.shiftKey||o!==i.length-1||(i[0].focus(),e.preventDefault())}(this.dialog,t))},o.prototype._maintainFocus=function(t){var e=t.target.getAttribute("data-a11y-dialog-show");this.shown&&!this.container.contains(t.target)&&e===this.container.id&&a(this.container)},"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",d):window.requestAnimationFrame?window.requestAnimationFrame(d):window.setTimeout(d,16));const l={name:"VueA11yDialog",props:{id:{type:String,required:!0},appRoot:{type:[String,Array],required:!0},dialogRoot:{type:String,required:!0},classNames:{type:Object,default:()=>({})},titleId:{type:String},closeButtonLabel:{type:String,default:"Close this dialog window"},disableNative:{type:Boolean,default:!1},role:{type:String,default:"dialog"}},computed:{fullTitleId(){return this.titleId||this.id+"-title"},dialogElement(){return this.disableNative?"div":"dialog"},roleAttribute(){return["dialog","alertdialog"].includes(this.role)?this.role:"dialog"},portalTarget(){return this.dialogRoot||this.appRoot}},data:()=>({dialog:null}),emits:["dialog-ref"],methods:{close(){this.dialog.hide()}},mounted(){this.$nextTick(function(){this.dialog=new o(this.$refs.rootElement,this.appRoot),this.$emit("dialog-ref",this.dialog)}.bind(this))},unmounted(){this.dialog&&this.dialog.destroy(),this.$emit("dialog-ref")}},h=e.createTextVNode(e.toDisplayString("Ã—"));l.render=function(t,i,o,n,s,a){return e.openBlock(),e.createBlock(e.Teleport,{to:a.portalTarget},[e.createVNode("div",{id:o.id,class:o.classNames.base,ref:"rootElement"},[e.createVNode("div",{"data-a11y-dialog-hide":"",tabIndex:"-1",class:o.classNames.overlay,onClick:i[1]||(i[1]=t=>"alertdialog"===o.role?void 0:a.close)},null,2),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(a.dialogElement),{role:a.roleAttribute,class:o.classNames.element,"aria-labelledby":a.fullTitleId},{default:e.withCtx((()=>[e.createVNode("div",{role:"document",class:o.classNames.document},[e.createVNode("button",{"data-a11y-dialog-hide":"",type:"button","aria-label":o.closeButtonLabel,onClick:i[2]||(i[2]=(...t)=>a.close&&a.close(...t)),class:o.classNames.closeButton},[e.renderSlot(t.$slots,"closeButtonContent",{},(()=>[h]))],10,["aria-label"]),e.createVNode("h1",{id:a.fullTitleId,class:o.classNames.title},[e.renderSlot(t.$slots,"title")],10,["id"]),e.renderSlot(t.$slots,"default")],2)])),_:3},8,["role","class","aria-labelledby"]))],10,["id"])],8,["to"])},t.A11yDialog=l,t.default=function(t){t.component("a11y-dialog",l)},Object.defineProperty(t,"__esModule",{value:!0}),t[Symbol.toStringTag]="Module"}));
